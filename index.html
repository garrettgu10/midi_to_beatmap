<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Peee</title>

        <script>
            const beatmap = [[48, 0, 12], [48, 1.333332, 26], [50, 2.666664, 40], [50, 3.1666635, 46], [50, 3.666663, 51], [50, 3.8333294999999996, 53], [48, 3.9999959999999994, 55], [48, 4.666662, 62], [48, 5.1666615, 67], [48, 5.333328, 69], [48, 5.6666609999999995, 72], [48, 5.999993999999999, 76], [48, 6.333326999999999, 80], [50, 6.6666599999999985, 83], [50, 6.999992999999998, 87], [50, 7.333325999999998, 90], [50, 7.6666589999999974, 94], [50, 7.833325499999997, 96], [48, 7.999991999999997, 97], [48, 8.499991499999998, 103], [48, 8.916657749999999, 107], [50, 9.333324, 112], [50, 9.99999, 119], [48, 10.666656000000001, 22], [48, 10.999989000000001, 51], [48, 11.333322000000003, 81], [48, 11.666655000000002, 110], [50, 11.833321500000002, 126], [48, 11.999988000000002, 14], [48, 12.333321000000002, 41], [48, 12.666654000000001, 66], [48, 12.999987, 92], [50, 13.1666535, 106], [48, 13.33332, 24], [48, 13.666653, 51], [48, 13.999986, 78], [48, 14.333319000000001, 106], [50, 14.499985500000003, 119], [48, 14.666652000000003, 98], [48, 14.999985000000002, 98], [48, 15.333318000000002, 98], [48, 15.666651000000002, 98], [48, 15.999984000000001, 22], [48, 16.333317, 43], [48, 16.666650000000004, 63], [48, 16.999983000000004, 84], [48, 17.166649500000002, 95], [48, 17.333316000000003, 98], [48, 17.666649000000003, 98], [48, 17.999982000000003, 98], [48, 18.333315000000002, 98], [48, 18.499981500000004, 98], [48, 18.666648000000002, 98], [48, 18.999981000000002, 22], [48, 19.333314, 41], [48, 19.666647, 59], [48, 19.833313500000003, 68], [48, 19.999980000000004, 78], [48, 20.166646500000006, 87], [48, 20.333313000000008, 96], [48, 20.49997950000001, 106], [48, 20.666646000000007, 98], [48, 20.83331250000001, 90], [48, 20.99997900000001, 75], [48, 21.16664550000001, 60], [48, 21.333312000000006, 44]];
            var canvas;
            var startTime;
            function init() {
                canvas = document.getElementById("myCanvas");
                ctx = canvas.getContext("2d");
                startTime = Date.now() + 1000;
                return setInterval(drawFrame, 10);
            }

            function drawFrame() {
                const currTime = (Date.now() - startTime) / 1000;
                console.log(currTime);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#FF0000";
                //draw an unfilled circle centered with radius 100
                ctx.beginPath();
                ctx.arc(400, 320, 100, 0, 2 * Math.PI);
                ctx.stroke();
                ctx.closePath();

                for (const beat of beatmap){
                    const [type, beatTime, pos] = beat;

                    ctx.fillStyle = type == 48? "#FF0000" : "#0000FF";

                    let dist = 100 + (beatTime - currTime) * 100;
                    const theta = pos / 127 * 2 * Math.PI;

                    if (dist < 100) dist = (dist - 95) * 20;
                    if (dist < 0) continue;

                    const x = 400 + dist * Math.cos(theta);
                    const y = 320 + dist * Math.sin(theta);

                    //draw a rectangle centered at (x, y) with width 10 and height 10
                    ctx.fillRect(x - 5, y - 5, 10, 10);
                }
            }

            window.onload = init;
        </script>
    </head>

    <body>
        <h1>My First Website</h1>
        <canvas id="myCanvas" width="800" height="640" style="border:1px solid #000000;">
    </body>
</html>